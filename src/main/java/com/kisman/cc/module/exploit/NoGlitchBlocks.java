package com.kisman.cc.module.exploit;

import com.kisman.cc.settings.*;
import com.kisman.cc.module.*;
import com.kisman.cc.Kisman;
import com.kisman.cc.event.Event;
import com.kisman.cc.event.events.*;

import me.zero.alpine.listener.*;

public class NoGlitchBlocks extends Module {
    public Setting place = new Setting("Place", this, true);
    public Setting break_ = new Setting("Break", this, true);
    public Setting ground = new Setting("Ground", this, false);

    public static NoGlitchBlocks instance;

    public NoGlitchBlocks() {
        super("NoGlitchBlocks", Category.EXPLOIT);

        instance = this;

        setmgr.rSetting(place);
        setmgr.rSetting(break_);
        setmgr.rSetting(ground);
    }

    public void onEnable() {
        Kisman.EVENT_BUS.subscribe(destroy);
    }

    public void onDisable() {
        Kisman.EVENT_BUS.unsubscribe(destroy);
    }

    @EventHandler
    private final Listener<DestroyBlockEvent> destroy = new Listener<>(event -> {
        if(break_.getValBoolean() && event.era.equals(Event.Era.PRE)) event.cancel();
    });

    public boolean noPlace(){
        return isToggled() && place.getValBoolean() && (ground.getValBoolean() || mc.player.onGround);
    }
}
