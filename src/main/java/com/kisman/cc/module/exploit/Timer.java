package com.kisman.cc.module.exploit;

import com.kisman.cc.Kisman;
import com.kisman.cc.event.events.EventPlayerUpdate;
import com.kisman.cc.module.*;
import com.kisman.cc.settings.Setting;
import me.zero.alpine.listener.*;

public class Timer extends Module {
    private Setting speed = new Setting("Ticks", this, 4, 0.1, 10, false);

    public Timer() {
        super("Timer", "", Category.EXPLOIT);

        setmgr.rSetting(speed);
    }

    public void onEnable() {
        Kisman.EVENT_BUS.subscribe(listener);
    }

    public void onDisable() {
        Kisman.EVENT_BUS.unsubscribe(listener);

        mc.timer.tickLength = 50;
    }

    @EventHandler private final Listener<EventPlayerUpdate> listener = new Listener<>(event -> mc.timer.tickLength = 50 / getSpeed());
    private float getSpeed() {return Math.max((float) speed.getValDouble(), 0.1f);}
}
