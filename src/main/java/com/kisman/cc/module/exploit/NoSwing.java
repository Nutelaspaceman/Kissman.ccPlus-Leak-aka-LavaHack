package com.kisman.cc.module.exploit;

import com.kisman.cc.Kisman;
import com.kisman.cc.event.events.PacketEvent;
import com.kisman.cc.module.Category;
import com.kisman.cc.module.Module;
import com.kisman.cc.settings.Setting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.network.play.client.CPacketAnimation;
import net.minecraft.util.EnumHand;

import java.util.ArrayList;
import java.util.Arrays;

public class NoSwing extends Module {
    private Setting mode = new Setting("Mode", this, Mode.Server);

    public NoSwing() {
        super("NoSwing", "", Category.EXPLOIT);

        setmgr.rSetting(mode);
    }

    public void onEnable() {
        Kisman.EVENT_BUS.subscribe(listener);
    }

    public void onDisable() {
        Kisman.EVENT_BUS.unsubscribe(listener);
    }

    public void update() {
        if(mc.player == null && mc.world == null) return;

        if(mode.getValString().equals(Mode.Client.name())) {
            mc.player.isSwingInProgress = false;
            mc.player.swingProgressInt = 0;
            mc.player.swingProgress = 0;
            mc.player.prevSwingProgress = 0;
        }
    }

    @EventHandler
    private final Listener<PacketEvent.Send> listener = new Listener<>(event -> {
        if(event.getPacket() instanceof CPacketAnimation && mode.getValString().equals(Mode.Server.name())) {
            event.cancel();
        }
    });

    public enum Mode {
        Client,
        Server
    }
}
